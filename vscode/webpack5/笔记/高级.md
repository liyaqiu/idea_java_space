test21-source-map
    官方文档
        https://webpack.js.org/configuration/devtool/#root
    配置
        /*
            生产环境一般不配置sourcemap功能，防止源码泄漏，在一个就是生成环境需要压缩，减少带宽
            eval 默认，每个moudle会封装到ecal里面包裹起来执行，并且会在末尾追加//@sourceURL
            source-map 生成一个SourceMap文件
            hidden-source-map 和source-map一样，但不会在bundle末尾追加注释
            inline-source-map 生成一个DataUrl形式的SourceMap文件
            eval-source-map 每个module会通过eval()来执行，并且生成一个DataUrl形式的SourceMap
            cheap-source-map 生成一个没有列信息的SourceMap文件，不包含loader的sourcemap，比如babel的sourcemap
            cheap-module-source-map 生成一个没有列信息的SourceMap文件，同时loader的sourcemap也被简化为只包含对应的行
        */
        devtool: 'cheap-module-source-map',

test22-dev-server
    /* 
        参考官方文档
            https://webpack.docschina.org/configuration/dev-server/#devserverproxy
     */
    devServer: {
        static: './dist',
        compress: false,
        /* host:'aaa.com', */
        port: 9999,
        open: true, //可以指定具体打开的页面open: ['/index.html'],
        hot:false, //模块热替换
        liveReload:true,//热加载，页面时时刷新，需要把hot禁用，否则刷新不了
        headers:{
            token1:'12345',
            token2:'56789'
        },
        //historyApiFallback: true, //Vue路由器模式为history模式，而不是hash模式的时候，刷新页面会有404问题，可以使用这个来解决
        //http2: true, //HTTP2 带有自签名证书
        /* https: {
            ca: './path/to/server.pem',
            pfx: './path/to/server.pfx',
            key: './path/to/server.key',
            cert: './path/to/server.crt',
            passphrase: 'webpack-dev-server',
            requestCert: true,
        }, */
        proxy: {
            '/server1': {
              target: 'http://cookie1.aaa.com:8899',
              pathRewrite:{'^/server1':''},
              //ws: true, //websocket使用
              /*
                changeOrigin: true
                    x-forwarded-host : 192.168.0.109:8080
                    x-forwarded-proto : http
                    x-forwarded-port : 8080
                    x-forwarded-for : 192.168.0.109
                    accept-language : zh-CN,zh;q=0.9
                    accept-encoding : gzip, deflate
                    referer : http://192.168.0.109:8080/index.html
                    user-agent : Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36
                    accept : application/json, text/plain
                    connection : close
                    host : cookie2.aaa.com:8899
                changeOrigin: false
                    x-forwarded-host : 192.168.0.109:8080
                    x-forwarded-proto : http
                    x-forwarded-port : 8080
                    x-forwarded-for : 192.168.0.109
                    accept-language : zh-CN,zh;q=0.9
                    accept-encoding : gzip, deflate
                    referer : http://192.168.0.109:8080/index.html
                    user-agent : Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36
                    accept : application/json, text/plain
                    connection : close
                    host : 192.168.0.109:8080
              */
              changeOrigin: true  //是否改变请求头的host属性的值
            },
            '/server2': {
              target: 'http://cookie2.aaa.com:8899',
              pathRewrite:{'^/server2':''},
              //ws: true, //websocket使用
              changeOrigin: true  //是否改变请求头的host属性的值
            },
        }
    },

test23-eslint-入门
    配置文档
        https://eslint.bootcss.com/docs/user-guide/configuring
    规则文档
        https://eslint.bootcss.com/docs/rules/
    安装文档
        https://webpack.docschina.org/plugins/eslint-webpack-plugin/
    安装
        npm i eslint -D
    创建配置文件，后面的工具都会根据这份配置文件进行语法检查 
        手动创建 .eslintrc.js
        命令创建 npx eslint --init
    语法检查
        方式1-手动执行命令进行检查
            npx eslint 检查的目录
        方式2-插件来进行检查
            安装
                vscode插件 ESLint
            配置
                .eslintignore 一定要放在根目录，否则不生效
                    dist 这个目录下的所有文件不会被eslint检查

        方式3-webpack打包进行检查
            安装
                npm i eslint-webpack-plugin -D
            配置
                const ESLintPlugin = require('eslint-webpack-plugin');
                plugins: [
                    new ESLintPlugin({
                        //使用说明，前提是需要在entry引入，或者被entry入口文件关联上，其次才会根据context来进行语法检查
                        context: path.resolve(__dirname, "../js_check")
                    })
                ],
        方式4
            此方式在开发阶段不会做代码检查，只有提交git的时候在检查
            整合git https://www.bilibili.com/video/BV1YU4y1g745?p=62&vd_source=cc17fab1d456bc3958dcb51e2fdd520b
        
test24-模块解析resolve-路径别名
    定义
        /* 设置别名路径 */
        alias: {
            '@js': path.resolve(__dirname, '../js'),
            '@ext': path.resolve(__dirname, '../extensions_m')
        },
    使用
        import test2 from '@js/test.js'
        test2(100,99)

test25-模块解析resolve-默认读取文件后缀的顺序
    定义
        /* 设置默认读取的文件后缀顺序 */
        extensions: ['.vue','.js','.json']
    使用
        /* 根据配置的后缀优先级读取文件 */
        import test3 from '@ext/hello'
        console.log(test3)

test26-externals-引入cdn库
    定义
        /* 标签方式引入第三方js库 */
        externalsType:'script', //指定生成页面的标签
        externals: {
            jqtest:['https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.js','$']
        }
    使用
        import jqtest from 'jqtest'
        console.log('jqtest',jqtest)

test27-模块依赖图
    有很多插件
        webpack-chart：webpack stats可交互饼图
        webpack-visualizer：可视化并分析你的bundle，检查哪些模块占用空间，哪些可能是重复使用的。
        webpack-bundle-analyzer：一个plugin和CLI工具，它将bundle内容展示为一个便捷的，交互式，可缩放的树状图形式
        webpack bundle optimize helper：这个工具会分析你的bundle，并提供可操作的改进措施，以减少bundle的大小
        bundle-stats：生成一个bundle报告(bundle大小，资源，模块)，并比较不同构建之间的结果
    以下案例webpack-bundle-analyzer
        安装
            npm i webpack-bundle-analyzer -D
        配置
            //模块依赖图插件
            const {BundleAnalyzerPlugin} = require('webpack-bundle-analyzer')
            plugins: [new BundleAnalyzerPlugin()]
        使用
            npm run dev 运行以后默认打开饼图

test28-css模块化
    安装
        参考test07-引入css文件
    配置
        非模块化
        {
            test: /\.(css|less)$/,
            exclude: [/css_module/,/mode_modules/],
            use: [MiniCssExtractPlugin.loader,'css-loader','less-loader'] // css合并&链接
        },
        模块化
        {
            test: /\.(css|less)$/,
            include: [/css_module/],
            use: [
                MiniCssExtractPlugin.loader,
                {
                    loader: 'css-loader',
                    options: {
                        modules: true
                    }
                },
                'less-loader'] // css合并&链接
        },
    使用
        <div id="box1">我是css1模块的样式</div>
        <div id="box2">我是css2模块的样式</div>

        import st1 from './css_module/box1.css'
        console.log('st1',st1)
        document.getElementById('box1').classList.add(st1.box)

        import st2 from './css_module/box2.css'
        console.log('st2',st2)
        document.getElementById('box2').classList.add(st2.box)

test29-css样式兼容性
    做了改动，需要查看test38-new-css样式兼容性
    安装
        npm i postcss-preset-env postcss-loader -D
    配置
        在package.json文件中添加，此句话不添加则不生效
            "browserslist":["> 1%","last 2 versions"]
            "browserslist":["> 1%","last 2 versions","not dead"]
        在common.config.js文件中配置
            非模块化
            {
                test: /\.(css|less)$/,
                exclude: [/css_module/, /mode_modules/],
                use: [
                    MiniCssExtractPlugin.loader,
                    'css-loader',
                    {
                        loader: 'postcss-loader',
                        options: {
                            postcssOptions: {
                                plugins: [
                                    'postcss-preset-env', //能够解决大部分css3样式兼容性问题
                                ],
                            },
                        },
                    },
                    'less-loader'
                ]
            },
            模块化
            {
                test: /\.(css|less)$/,
                include: [/css_module/],
                use: [
                    MiniCssExtractPlugin.loader,
                    {
                        loader: 'css-loader',
                        options: {
                            modules: true //开启模块化css
                        }
                    },
                    {
                        loader: 'postcss-loader',
                        options: {
                            postcssOptions: {
                                plugins: [
                                    'postcss-preset-env', //能够解决大部分css3样式兼容性问题
                                ],
                            },
                        },
                    },
                    'less-loader'
                ]
            },
    使用
        在css文件中添加样式，可以查看是否添加了前缀兼容性
            display: flex

test30-entry
    1入口，1出口
        方式1
            entry: './src/main.js',
            filename: 'bundle.js',
            splitChunks: {
                /*  chunks: 'all' */  //需要关闭文件分离
            },
        方式2
            entry: {index1: './src/main.js'},
            filename: './js/[name].bundle.js'
            splitChunks: {
                /*  chunks: 'all' */  //需要关闭文件分离
            },
    1入口，多出口
        方式1
            entry: './src/main.js',
            filename: './js/[name].bundle.js',
            splitChunks: {
                chunks: 'all' 
            },
        方式2
            entry: {index1: './src/main.js'},
            filename: './js/[name].bundle.js',
            splitChunks: {
                chunks: 'all' 
            },
    多入口，1出口
        entry: ['./src/main.js','./src/main2.js','./src/main3.js'],
        output: {filename: 'bundle.js',}
        splitChunks: {
           /*  chunks: 'all' */  //需要关闭文件分离
        },

    多入口，多出口
        entry: {
            index1: './src/main.js',
            index2: './src/main2.js',
            index3: './src/main3.js'
        },
        filename: './js/[name].bundle.js',
        splitChunks: {
           chunks: 'all' 
        },
    混合入口，多出口
        方式1
            entry: {
                index1: ['./src/main.js','./src/main2.js'],
                index3: './src/main3.js'
            },
            filename: './js/[name].bundle.js',
            splitChunks: {
                chunks: 'all' 
            },
        方式2
            entry: {
                index1:{
                    import: ['./src/main.js','./src/main2.js'],
                    dependOn: 'testjs',
                    filename: './index1js/[name].bundle.js',
                },
                index3: './src/main3.js',
                testjs: './src/js/test.js'
            },
            filename: './comm_js/[name].bundle.js',
            splitChunks: {
                chunks: 'all' 
            },

test30-HtmlWebpackPlugin-更改页面信息
    配置
        new HtmlWebpackPlugin({
            title: '我的项目',
            content1: '我是css1模块的样式',
            content2: '我是css2模块的样式',
            template: './public/index.html', //指定html模版，如果不指定，则默认生成
            filename: './index.html', //指定名字
            inject: 'body' //指定生成的<script>标签生成的位置
        }),
    使用
        <title><%= htmlWebpackPlugin.options.title %></title>
        <div id="box1"><%= htmlWebpackPlugin.options.content1 %></div>
        <div id="box2"><%= htmlWebpackPlugin.options.content2 %></div>

test30-HtmlWebpackPlugin-指定js引入
    配置
        entry: {
            index1: {
                import: ['./src/main.js', './src/main2.js'],
                dependOn: 'testjs'
            },
            index3: './src/main3.js',
            testjs: './src/js/test.js'
        },
    使用
        new HtmlWebpackPlugin({
            title: '我的项目',
            content1: '我是css1模块的样式',
            content2: '我是css2模块的样式',
            template: './public/index.html', //指定html模版，如果不指定，则默认生成
            filename: './index.html', //指定名字
            inject: 'body', //指定生成的<script>标签生成的位置
            chunks: ['index1','testjs'] //指定引入的js文件
        }),
    
test31.3-HtmlWebpackPlugin-多页面
        配置
            new HtmlWebpackPlugin({
                title: '我的项目',
                content1: '我是css1模块的样式',
                content2: '我是css2模块的样式',
                template: './public/index.html', //指定html模版，如果不指定，则默认生成
                filename: './index.html', //指定名字
                inject: 'body', //指定生成的<script>标签生成的位置
                chunks: ['index1','testjs'], //指定引入的js文件，默认不写则为全部引入
                /* publicPath: 'http://www.a.com' */
            }),
            new HtmlWebpackPlugin({
                title: '我的项目',
                content1: '我是css1模块的样式',
                content2: '我是css2模块的样式',
                template: './public/index.html', //指定html模版，如果不指定，则默认生成
                filename: './app3/index3.html', //指定名字
                inject: 'body', //指定生成的<script>标签生成的位置
                chunks: ['index3'], //指定引入的js文件，默认不写则为全部引入
                publicPath: 'http://www.b.com'
            }),

test32-摇树-TreeShaking
    配置
        optimization:{
            usedExports: true //摇树TreeShaking ,默认在生产模式下也会进行摇树的
        }
        在package.json文件中配置
        "sideEffects": false, 告诉webpack，全部文件没副作用，随便摇树
        "sideEffects": true,  默认，告诉webpack，全部文件都有副作用，不能随便摇树
        "sideEffects": ["*.css","*test1.less"],, 全部css不要随便摇树，test1.less不要随便摇树，其他都可以随便摇树

test33-devServer-重新写入dist
    配置
        devMiddleware:{
            writeToDisk:true, //重新写入dist
        },

test34-Shimming定义全局变量
    配置
        const webpack = require('webpack')
        plugins: [
            new webpack.ProvidePlugin(
                {
                    myGlobalObj:path.resolve('./src/globaljs/myglobal.js'), //自己的全局对象
                    globalObj:'lodash' //第三方的全局对象
                }
            )
        ]
    使用
        console.log('自己的全局变量',myGlobalObj.add(1000,2000))
        console.log(globalObj.join(['第三方全局变量','hello','world']))

test35-构建本地库-es5使用
    配置
        entry: './src/mylibrary/mylib.js',
        output: {
            filename: 'mylib.js',
            path: path.resolve(__dirname, '../../dist'),
            clean: true, //每次都清理dist目录
            library: {
                name: 'mylib',
                type: 'window'
            }
        },
        splitChunks: {
            /* chunks: 'all' */ //关闭此处，否则依赖会分离
        }
    使用
        npm run pro 可以打成压缩版本的
        npm run dev 可以打成不压缩版本的

test35.2-构建本地库-commonjs使用
    配置
        entry: './src/mylibrary/mylib.js',
        output: {
            filename: 'mylib.js',
            path: path.resolve(__dirname, '../../dist'),
            clean: true, //每次都清理dist目录
            library: {
                name: 'mylib',
                type: 'commonjs'
            }
        },
        splitChunks: {
            /* chunks: 'all' */ //关闭此处，否则依赖会分离
        }
    使用
        npm run pro 可以打成压缩版本的
        npm run dev 可以打成不压缩版本的

test35.2-构建本地库-es6使用
    配置
        entry: './src/mylibrary/mylib.js',
        /* es6打包需要的 */
        experiments: {
            outputModule: true
        },
        output: {
            filename: 'mylib.js',
            path: path.resolve(__dirname, '../../dist'),
            clean: true, //每次都清理dist目录
            library: {
                /* name: 'mylib', */
                type: 'module'
            }
        },
        splitChunks: {
            /* chunks: 'all' */ //关闭此处，否则依赖会分离
        }
    使用
        npm run pro 可以打成压缩版本的
        npm run dev 可以打成不压缩版本的

test35.2-构建本地库-umd(es5+commonjs)
    可以同时支持es5和commonjs
    配置
        entry: './src/mylibrary/mylib.js',
        output: {
            filename: 'mylib.js',
            path: path.resolve(__dirname, '../../dist'),
            clean: true, //每次都清理dist目录
            library: {
                name: 'mylib',
                type: 'umd'
            },
            globalObject: 'globalThis'
        },
        splitChunks: {
            /* chunks: 'all' */ //关闭此处，否则依赖会分离
        }
    使用
        npm run pro 可以打成压缩版本的
        npm run dev 可以打成不压缩版本的

test36-new-eslint-高级使用
    查看test23-eslint-入门帮助文档
test37-new-babel-高级使用
    test12-js-es6转es5语法
test38-new-css样式兼容性
    test29-css样式兼容性

test39-new-本地图片无损压缩
    官方
        https://webpack.js.org/plugins/image-minimizer-webpack-plugin/
    安装
        npm i image-minimizer-webpack-plugin imagemin -D
        npm install -g cnpm 下载失败，所以需要用到cnpm来下载
        cnpm i imagemin-gifsicle imagemin-jpegtran imagemin-optipng imagemin-svgo -D
    配置
        //本地图片压缩
        const ImageMinimizerPlugin = require("image-minimizer-webpack-plugin");
        /* 本地图片无损压缩，在线图片压缩不了 */
        new ImageMinimizerPlugin({
            minimizer:{
                implementation: ImageMinimizerPlugin.imageminGenerate,
                options:{
                    plugins: [
                        ["gifsicle", { interlaced: true }],
                        ["jpegtran", { progressive: true }],
                        ["optipng", { optimizationLevel: 5 }],
                        // Svgo configuration here https://github.com/svg/svgo#configuration
                        [
                            "svgo",
                            {
                                plugins: [
                                    "preset-default",
                                    "prefixIds",
                                    {
                                        name: "sortAttrs",
                                        params: {
                                            xmlnsOrder: "alphabetical",
                                        }
                                    }
                                ]
                            },
                        ],
                    ],
                }
            }
        }),
    

test40-new-代码分割
    optimization: {
        /* 
            //https://webpack.js.org/plugins/split-chunks-plugin/#optimizationsplitchunks
            配置重复代码自动分离
         */
        splitChunks: {
            chunks: 'all', //对所有模块都进行分割
            /* 
            全局配置
            minSize: 20000, //分割代码最小的值
            minRemainingSize: 0, //确保最后提取文件大小不能为0
            minChunks: 1, //至少被引用几次，满足条件才会进行代码分割
            maxAsyncRequests: 30, //按需加载时，并行加载的文件的最大数量
            maxInitialRequests: 30, //入口js文件最大并行请求数量
            enforceSizeThreshold: 50000, //超过50kb一定会单独打包(此时会忽略minRemainingSize、maxAsyncRequests、maxInitialRequests)
            cacheGroups: { //组，哪些模块要打包到一个组
                defaultVendors: { //组名，局部配置
                    test: /[\\/]node_modules[\\/]/, //匹配到的这些都要打包到一个组
                    priority: -10, //值越大权重越大
                    reuseExistingChunk: true, //如果当前chunk包含已从主bundle中拆分出模块，则它将被重用，而不是生成新的模块
                },
                default: { //默认组名，局部配置
                    minChunks: 2,
                    priority: -20,
                    reuseExistingChunk: true,
                },
            }, 
            */
        },
        usedExports: true, //摇树TreeShaking ,默认在生产模式下也会进行摇树的
    },

test42-new-corejs-对es7及以上的js做转换es5
    安装
        cnpm i core-js -D
    配置
        方式1，手动引入
            //import 'core-js' //全部引入
            //import 'core-js/es/promise' //按需引入
        方式2，动态引入
            babel.config.js
                presets: [
                    [
                    '@babel/preset-env',
                    {
                        useBuiltIns: "usage",
                        corejs: 3
                    }
                    ]
                ],
    
test43-new-复制文件
    官方文档
        https://www.npmjs.com/package/copy-webpack-plugin#globoptions
    安装
        cnpm i copy-webpack-plugin -D
    配置
        //拷贝文件插件
        const CopyPlugin = require("copy-webpack-plugin");
        new CopyPlugin({
            patterns: [
                { 
                    from: "./public", 
                    to: "./",
                    globOptions: {
                        ignore: ["**/index.html"],
                    }, 
                },
               /*  { from: "other", to: "public" }, */
            ],
        }),
